cmake_minimum_required(VERSION 3.31)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include($ENV{IDF_PATH}/tools/cmake/project.cmake)

set(PROJECT_VERSION_MAJOR 3)
set(PROJECT_VERSION_MINOR 5)
set(DOG_VERSION "${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}")

execute_process(
    COMMAND git describe --always --dirty
    WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}
    OUTPUT_VARIABLE GIT_REV
    OUTPUT_STRIP_TRAILING_WHITESPACE
)

# ESP32 with one of: WEMOS32, ESP32_S3_QTPY, ESP32_S3_XIAO, ESP32_S3_WAVESHARE
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DDOG_VERSION=\"\\\"${DOG_VERSION}\\\"\" -DESP32 -DESP32_S3_XIAO -fexceptions -DGIT_REVISION=\"\\\"${GIT_REV}\\\"\"")

project(esp32chesstest)

idf_build_set_property(MINIMAL_BUILD ON)
